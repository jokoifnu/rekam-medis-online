<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rekam Medis Pasien</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body {
            background-color: #e9ecef;
            font-family: 'Arial', sans-serif;
        }
        .container {
            margin-top: 30px;
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        h1, h2 {
            color: #343a40;
        }
        th {
            background-color: #007bff;
            color: white;
        }
        .btn {
            margin-top: 10px;
        }
        .icon {
            margin-right: 5px;
        }
        footer {
            margin-top: 30px;
            text-align: center;
            font-size: 0.9em;
            color: #6c757d;
        }
        .obat-search {
            margin-top: 20px;
        }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand" href="#">Rekam Medis</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
</nav>

<div class="container">
    <h1 class="text-center">RUMAH SAKIT FAJAR MEDIKA</h1>
    <h2 class="text-center">Pencatatan Rekam Medis Pasien</h2>
    
    <form id="rekamMedisForm" class="mb-4">
        <div class="form-group">
            <label for="nomorRekamMedis">Nomor Rekam Medis:</label>
            <input type="text" id="nomorRekamMedis" name="nomorRekamMedis" class="form-control" required>
        </div>

        <div class="form-group">
            <label for="nama">Nama Pasien:</label>
            <input type="text" id="nama" name="nama" class="form-control" required>
        </div>

        <div class="form-group">
            <label for="umur">Umur:</label>
            <input type="number" id="umur" name="umur" class="form-control" required>
        </div>

        <div class="form-group">
            <label for="jenisKelamin">Jenis Kelamin:</label>
            <select id="jenisKelamin" name="jenisKelamin" class="form-control" required>
                <option value="Laki-laki">Laki-laki</option>
                <option value="Perempuan">Perempuan</option>
            </select>
        </div>

        <div class="form-group">
            <label for="diagnosis">Diagnosis:</label>
            <textarea id="diagnosis" name="diagnosis" class="form-control" rows="4" required></textarea>
        </div>

        <div class="form-group">
            <label for="pemeriksaanPenunjang">Hasil Pemeriksaan Penunjang:</label>
            <textarea id="pemeriksaanPenunjang" name="pemeriksaanPenunjang" class="form-control" rows="4"></textarea>
        </div>

        <div class="form-group">
            <label for="alergi">Alergi:</label>
            <input type="text" id="alergi" name="alergi" class="form-control">
        </div>

        <div class="form-group">
            <label for="catatanDokter">Catatan Dokter:</label>
            <textarea id="catatanDokter" name="catatanDokter" class="form-control" rows="4"></textarea>
        </div>

        <div class="form-group">
            <label for="tanggal">Tanggal Pemeriksaan:</label>
            <input type="date" id="tanggal" name="tanggal" class="form-control" required>
        </div>

        <div class="form-group obat-search">
            <label for="obat">Obat yang Diberikan:</label>
            <input type="text" id="obatSearch" class="form-control" placeholder="Cari Obat..." onkeyup="searchObat()">
            <ul id="obatList" class="list-group mt-2"></ul>
        </div>

        <div class="form-group">
            <label for="dosis">Dosis Obat:</label>
            <select id="dosis" class="form-control" disabled>
                <option value="">Pilih Dosis</option>
                <!-- Dosis obat akan diisi melalui JavaScript -->
            </select>
        </div>

        <button type="button" class="btn btn-primary" id="simpanButton" onclick="tambahRekamMedis()">
            <i class="fas fa-save icon"></i> Simpan Rekam Medis
        </button>
    </form>

    <h2 class="mt-5">Daftar Rekam Medis Pasien</h2>
    <table class="table table-striped" id="rekamMedisTable">
        <thead>
            <tr>
                <th>Nomor Rekam Medis</th>
                <th>Nama Pasien</th>
                <th>Umur</th>
                <th>Jenis Kelamin</th>
                <th>Tanggal Pemeriksaan</th>
                <th>Diagnosis</th>
                <th>Hasil Pemeriksaan</th>
                <th>Alergi</th>
                <th>Catatan Dokter</th>
                <th>Obat</th>
                <th>Dosis</th>
                <th>Aksi</th>
            </tr>
        </thead>
        <tbody>
            <!-- Data rekam medis akan ditambahkan di sini -->
        </tbody>
    </table>
</div>

<footer>
    <p>Created by Joko Ifnu Fajar</p>
    <p>Copyright by Fajar Digital IT Solution</p>
</footer>

<script>
    const rekamMedisData = JSON.parse(localStorage.getItem('rekamMedisData')) || [];
    const daftarObat = [
        { name: "Paracetamol", brand: "Panadol", dosis: ["500 mg", "1 g"] },
        { name: "Ibuprofen", brand: "Brufen", dosis: ["200 mg", "400 mg"] },
        { name: "Amoxicillin", brand: "Amoxan", dosis: ["250 mg", "500 mg"] },
        { name: "Ciprofloxacin", brand: "Cipro", dosis: ["250 mg", "500 mg"] },
        // Tambahkan lebih banyak obat dengan dosisnya di sini
    ];

    function searchObat() {
        const query = document.getElementById('obatSearch').value.toLowerCase();
        const obatListElement = document.getElementById('obatList');
        obatListElement.innerHTML = '';

        const filteredObat = daftarObat.filter(obat => obat.name.toLowerCase().includes(query));
        filteredObat.forEach(obat => {
            const li = document.createElement('li');
            li.className = 'list-group-item';
            li.textContent = `${obat.name} (${obat.brand})`;
            li.onclick = () => selectObat(obat);
            obatListElement.appendChild(li);
        });
    }

    function selectObat(obat) {
        document.getElementById('obatSearch').value = obat.name;
        const dosisSelect = document.getElementById('dosis');
        dosisSelect.innerHTML = '<option value="">Pilih Dosis</option>';
        obat.dosis.forEach(d => {
            const option = document.createElement('option');
            option.value = d;
            option.textContent = d;
            dosisSelect.appendChild(option);
        });
        dosisSelect.disabled = false;
        document.getElementById('obatList').innerHTML = '';
    }

    function renderTable() {
        const Body = document.getElementById('rekamMedisTable').getElementsByTagName('tbody')[0];
        Body.innerHTML = '';
        rekamMedisData.forEach((data, index) => {
            const newRow = Body.insertRow();
            newRow.insertCell(0).innerText = data.nomorRekamMedis;
            newRow.insertCell(1).innerText = data.nama;
            newRow.insertCell(2).innerText = data.umur;
            newRow.insertCell(3).innerText = data.jenisKelamin;
            newRow.insertCell(4).innerText = data.tanggal;
            newRow.insertCell(5).innerText = data.diagnosis;
            newRow.insertCell(6).innerText = data.pemeriksaanPenunjang || 'Tidak Ada';
            newRow.insertCell(7).innerText = data.alergi || 'Tidak Ada';
            newRow.insertCell(8).innerText = data.catatanDokter || 'Tidak Ada';
            newRow.insertCell(9).innerText = data.obat.join(', ') || 'Tidak Ada';
            newRow.insertCell(10).innerText = data.dosis.join(', ') || 'Tidak Ada';
            const aksiCell = newRow.insertCell(11);
            aksiCell.innerHTML = `<button class="btn btn-warning" onclick="editRekamMedis(${index})">Edit</button> 
                                  <button class="btn btn-danger" onclick="hapusRekamMedis(${index})">Hapus</button>`;
        });
    }

    function tambahRekamMedis() {
        const nomorRekamMedis = document.getElementById('nomorRekamMedis').value;
        const nama = document.getElementById('nama').value;
        const umur = document.getElementById('umur').value;
        const jenisKelamin = document.getElementById('jenisKelamin').value;
        const diagnosis = document.getElementById('diagnosis').value;
        const pemeriksaanPenunjang = document.getElementById('pemeriksaanPenunjang').value;
        const alergi = document.getElementById('alergi').value;
        const catatanDokter = document.getElementById('catatanDokter').value;
        const tanggal = document.getElementById('tanggal').value;
        const obat = [document.getElementById('obatSearch').value];
        const dosis = [document.getElementById('dosis').value];

        const newRecord = { nomorRekamMedis, nama, umur, jenisKelamin, diagnosis, pemeriksaanPenunjang, alergi, catatanDokter, tanggal, obat, dosis };
        rekamMedisData.push(newRecord);
        localStorage.setItem('rekamMedisData', JSON.stringify(rekamMedisData));
        renderTable();
        document.getElementById('rekamMedisForm').reset();
        document.getElementById('obatList').innerHTML = '';
        document.getElementById('dosis').value = '';
        document.getElementById('dosis').disabled = true;
    }

    function editRekamMedis(index) {
        const data = rekamMedisData[index];
        document.getElementById('nomorRekamMedis').value = data.nomorRekamMedis;
        document.getElementById('nama').value = data.nama;
        document.getElementById('umur').value = data.umur;
        document.getElementById('jenisKelamin').value = data.jenisKelamin;
        document.getElementById('diagnosis').value = data.diagnosis;
        document.getElementById('pemeriksaanPenunjang').value = data.pemeriksaanPenunjang;
        document.getElementById('alergi').value = data.alergi;
        document.getElementById('catatanDokter').value = data.catatanDokter;
        document.getElementById('tanggal').value = data.tanggal;

        const obat = data.obat.join(', ');
        document.getElementById('obatSearch').value = obat;
        document.getElementById('obatList').innerHTML = '';

        const dosis = data.dosis.join(', ');
        document.getElementById('dosis').value = dosis;
        selectObat(data.obat[0]);  // Mengisi dosis berdasarkan obat yang dipilih
    }

    function hapusRekamMedis(index) {
        rekamMedisData.splice(index, 1);
        localStorage.setItem('rekamMedisData', JSON.stringify(rekamMedisData));
        renderTable();
    }

    renderTable();
</script>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
